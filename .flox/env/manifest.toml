version = 1

[vars]
GOPATH = "$HOME/go"
GOPROXY = "https://proxy.golang.org,direct"
GOSUMDB = "sum.golang.org"
GO111MODULE = "on"
CGO_ENABLED = "1"

PROJECT_NAME = "inference-gateway"
PROJECT_DESCRIPTION = "An open-source, high-performance gateway unifying multiple LLM providers, from local solutions like Ollama to major cloud providers such as OpenAI, Groq, Cohere, Anthropic, Cloudflare, DeepSeek and more."

[install]
go.pkg-path = "go"
go.version = "^1.25.4"
docker.pkg-path = "docker"
docker.version = "^28.5.1"
docker-compose.pkg-path = "docker-compose"
docker-compose.version = "^2.39.4"
go-task.pkg-path = "go-task"
go-task.version = "^3.45.5"
golangci-lint.pkg-path = "golangci-lint"
golangci-lint.version = "^2.6.2"
curl.pkg-path = "curl"
curl.version = "^8.17.0"
jq.pkg-path = "jq" 
jq.version = "^1.8.1"
git.pkg-path = "git"
git.version = "^2.51.2"
gh.pkg-path = "gh"
gh.version = "^2.83.1"
kubectl.pkg-path = "kubectl"
kubectl.version = "^1.34.2"
kubernetes-helm.pkg-path = "kubernetes-helm"
kubernetes-helm.version = "^3.19.1"
ctlptl.pkg-path = "ctlptl"
ctlptl.version = "^0.8.43"
k3d.pkg-path = "k3d"
k3d.version = "^5.8.3"
mockgen.pkg-path = "mockgen"
mockgen.version = "^0.6.0"
nodejs_24.pkg-path = "nodejs_24"
nodejs_24.version = "^24.11.1"
prettier.pkg-path = "prettier"
prettier.version = "^3.6.2"
claude-code.pkg-path = "claude-code"
claude-code.version = "^2.0.59"
goreleaser.pkg-path = "goreleaser"
goreleaser.version = "^2.13.0"
markdownlint-cli.pkg-path = "markdownlint-cli"
markdownlint-cli.version = "^0.46.0"

[hook]
on-activate = """
  echo "üöÄ Welcome to $PROJECT_NAME development environment!"
  echo "üìù $PROJECT_DESCRIPTION"
  echo ""
  echo "üì¶ Available tools and commands:"
  echo "  task --list             # Show all available tasks"
  echo "  task build              # Build the gateway"
  echo "  task run                # Run the gateway locally"
  echo "  task test               # Run tests"
  echo "  task lint               # Run linting"
  echo "  task generate           # Generate code from schemas"
  echo "  task pre-commit:install # Install git hooks"
  echo "  spec lint <file>        # Lint OpenAPI/JSON Schema files"
  echo ""
  echo "üîß Getting started checklist:"
  echo "  1. Run 'task pre-commit:install' to set up git hooks"
  echo "  2. Run 'task build' to build the project"
  echo "  3. Run 'task test' to verify everything works"
  echo ""
  
  mkdir -p "$GOPATH/bin"
  
  mkdir -p bin
  
  export GOENV="$FLOX_ENV_CACHE/goenv"

  if [ -f go.mod ]; then
    echo "üì• Installing Go dependencies..."
    go mod download
    echo "‚úÖ Go dependencies installed"
  fi

  # Install infer CLI if not already installed
  if ! command -v infer >/dev/null 2>&1; then
    echo "üì• Installing infer CLI..."
    curl -fsSL https://raw.githubusercontent.com/inference-gateway/cli/main/install.sh | bash -s -- --install-dir $HOME/.local/bin
    echo "‚úÖ infer CLI installed"
  else
    echo "‚úÖ infer CLI already installed"
  fi
"""

[profile]
common = '''
  alias gs="git status"
  alias gl="git log --oneline -10"
  alias gd="git diff"
  
  alias build="task build"
  alias test="task test"
  alias lint="task lint"
  alias gen="task generate"
  alias spec="npx @stoplight/spectral-cli"
'''

zsh = '''
  if command -v go >/dev/null 2>&1; then
    autoload -U compinit
    compinit
  fi
'''

bash = '''
  if [ -f /etc/bash_completion ] && ! shopt -oq posix; then
    . /etc/bash_completion
  fi
'''

[options]
systems = [
  "aarch64-darwin",
  "aarch64-linux", 
  "x86_64-darwin",
  "x86_64-linux",
]
cuda-detection = false
